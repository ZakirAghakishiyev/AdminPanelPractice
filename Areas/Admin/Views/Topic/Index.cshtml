@using AdminPanelPractice.DataContext.Entities
@model List<Topic>

<table>
	<thead>
		<tr>
			<th>ID</th>
			<th>Title</th>
			<th>Image</th>
		</tr>
	</thead>
	<tbody>
		@foreach(var item in Model){
			<tr>
				<td>@item.Id</td>.
				<td>@item.Title</td>
				<td><img src="~/images/topic/@item.CoverImgUrl" alt="@item.Title" style="width: 75px"/></td>
				<td>
					<a asp-controller="slider" asp-action="update" asp-route-id="@item.Id" class="btn btn-warning" style="width: 75px">Update</a>
					<a onclick="DeleteFunc(@item.Id,this)" class="btn btn-warning" style="width: 75px; background-color:red">Delete</a>
				</td>

			</tr>
		}
	</tbody>
</table>

<script>
    function DeleteFunc(id, button){
    const url = '/admin/topic/delete';
    const data = {
      id: id,
    };

    const options = {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(data)
    };

    fetch(url, options)
      .then(response => {
        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }
        button.parentNode.parentNode.remove();
      })
      .catch(error => {
        console.error('Error:', error);
      });

    }
</script>